# Today I Learned(TIL) Wiki

## :sparkles: 25.02.12(ìˆ˜)
[USER / PROJECT]
- [x] GetRes value ê°’ í†µì¼í•˜ê¸°

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### CORS 
- ìì› ê³µìœ . ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ resourceë¥¼ ìš”ì²­í•˜ê²Œ ëœë‹¤ë©´, ê·¸ ìì›ì— ëŒ€í•œ corsAllowë¥¼ í•´ì¤˜ì•¼ë§Œ ê·¸ ìì›ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤!

#### OAuth ë¡œê·¸ì¸/íšŒì›ê°€ì… ì¸ì¦.
- OAuth: Open Authorization
```

```

## :sparkles: 25.02.10(ì›”)
[INSTRUMENT]
- [x] ìœ ì € ì•…ê¸° ì¶”ê°€ ë° ì¡°íšŒ
- [x] í”„ë¡œì íŠ¸ ì•…ê¸°, ê¸°íƒ€ ì•…ê¸° ì¡°íšŒ

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### HTTPS swagger CORS ë¬¸ì œ
```
public OpenAPI openAPI() {

    SecurityScheme securityScheme = new SecurityScheme()
            .type(SecurityScheme.Type.HTTP)
            .scheme("Bearer")
            .bearerFormat("JWT")
            .in(SecurityScheme.In.HEADER)
            .name("Authorization");

    SecurityRequirement securityRequirement = new SecurityRequirement().addList("bearerAuth");

    return new OpenAPI().servers(List.of(
                    new Server().url("https://api.blendeo.shop")  // HTTPS URLë¡œ ì„¤ì •
                    ))
                    .components(new Components()
                    .addSecuritySchemes("bearerAuth", securityScheme)) // API êµ¬ì„± ìš”ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
            .security(Arrays.asList(securityRequirement))
            .info(apiInfo()); // API ì •ë³´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
}
```
### https://api.blendeo.shop/swagger-ui/index.html

ì—ì„œ ìš”ì²­í–ˆì§€ë§Œ ë°˜í™˜ì€ httpë¡œ ìš”ì²­ì´ ë˜ì–´ì„œ CORS(ë¦¬ì†ŒìŠ¤ì˜ ìœ„ì¹˜ê°€ ì˜ëª» ì„¤ì •ëœ ì—ëŸ¬)

```
curl -X 'POST' \
	'http://api.blendeo.shop/api/v1/user/auth/login' \
	-H 'accept: */*' \
	-H 'Content-Type: application/json' \
	-d '{
	"email": "[test1@gmail.com](mailto:test1@gmail.com)",
	"password": "test1"
}
```

After Trouble Shooting
```
curl -X 'POST' \
  'https://api.blendeo.shop/api/v1/user/auth/login' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d '{
  "email": "test1@gmail.com",
  "password": "test1"
}'
```
#### Spring Security
```
@Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .cors(cors -> cors.configurationSource(corsConfigurationSource())) // CORS ì„¤ì • ì¶”ê°€
                .csrf(csrf -> csrf.disable()) // CSRF ë¹„í™œì„±í™”
                .authorizeHttpRequests(auth -> auth
                        // Swagger ê´€ë ¨ ìš”ì²­ ì¸ì¦ ì œì™¸
                        .requestMatchers(
                                "/ws-stomp/**",
                                "/swagger-ui/**",
                                "/v3/api-docs/**",
                                "/swagger-resources/**",
                                "/webjars/**",
                                "/configuration/ui",
                                "/configuration/security",
                                "/api/v1/**"
                        ).permitAll()
                        // ë‚˜ë¨¸ì§€ ìš”ì²­ì€ ì¸ì¦ í•„ìš”
                        .anyRequest().authenticated()
                )
                .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class) // JWT í•„í„° ì¶”ê°€
                .httpBasic(AbstractHttpConfigurer::disable); // HTTP Basic ì¸ì¦ ë¹„í™œì„±í™”
        return http.build();
    }
```
1. SecurityConfig: FilterëŠ” ì• ì´ˆì— ì´ ì›¹ ì‚¬ì´íŠ¸ì— ë“¤ì–´ê°€ëŠ” ì¸ì¦ ê¶Œí•œì„ ì ê²€í•œë‹¤.
-> ì¼ë°˜ ìœ ì €ì™€ ì›¹ í˜ì´ì§€ ê´€ë¦¬ì ê°„ ê¶Œí•œ ì¸ì¦!
-> í˜ì´ì§€ ì ‘ê·¼ ê¶Œí•œì´ ì—†ë‹¤ë©´ 401 ERROR ë°˜í™˜
2. HttpBasic ì¸ì¦ì´ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´
-> ì„œë²„ì—ì„œ www-authenticate: Basic realm="Realm" ë¡œ ì‘ë‹µí•´ì„œ 401ì—ëŸ¬ê°€ ë°œìƒ


```
@Override
    protected boolean shouldNotFilter(HttpServletRequest request) throws ServletException {
        // Filterì— ê±¸ë¦¬ë©´ ì•ˆë˜ëŠ” url(ë¡œê·¸ì•„ì›ƒ, í† í° ì¬ë°œê¸‰)
        return request.getRequestURI().startsWith("/swagger-ui/index.html")
                || request.getRequestURI().startsWith("/swagger-ui")
                || request.getRequestURI().startsWith("/v3/api-docs")
                || request.getRequestURI().startsWith("/swagger-resources")
                || request.getRequestURI().startsWith("/api/v1/user/auth")
                || request.getRequestURI().startsWith("/api/v1/user/get-user")
                || request.getRequestURI().startsWith("/webjars")
                || request.getRequestURI().startsWith("/configuration")
                || request.getRequestURI().startsWith("/api/v1/project/new")
                || request.getRequestURI().startsWith("/api/v1/project/info")
                || request.getRequestURI().startsWith("/api/v1/rank")
                || request.getRequestURI().startsWith("/api/v1/instrument")
                || request.getRequestURI().startsWith("/ws-stomp");
    }
```
JwtTokenFilterëŠ” accessToken ì„ ê²€ì¦í•  í•„í„°ë¥¼ ì§€ì •í•´ì¤€ë‹¤.
-> accessTokenì´ ì˜ëª»ë˜ì—ˆê±°ë‚˜ ë“¤ì–´ì˜¤ì§€ ì•Šì•˜ë‹¤ë©´, 403 Forbidden ERRORì„ ë°˜í™˜í•œë‹¤.

## :sparkles: 25.02.07(ê¸ˆ)
[CHAT]
- [x] MR ìš”ì²­ ë° ì¶©ëŒ í•´ê²°

[INFRA]
- [x] ë°°í¬ ë°©ì‹ ìˆ˜ì •

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### SSE Emitter ì‚¬ìš©í•˜ëŠ” ì´ìœ 
- SSE : Server-Sent-Eventì˜ ì•½ì. ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ë¥¼ ì „ë‹¬í•˜ëŠ” ì›¹ ê¸°ìˆ 
- í´ë¼ì´ì–¸íŠ¸ ë³„ë„ ì¶”ê°€ìš”ì²­ ì—†ì´ ì„œë²„ì—ì„œ ì—…ë°ì´íŠ¸ ìŠ¤íŠ¸ë¦¬ë° ê°€ëŠ¥

#### /pub, /sub websocket ì‹¤ì‹œê°„ ë©”ì‹œì§€


## :sparkles: 25.02.06(ëª©)
[CHAT]
- [x] webSocket ì—°ê²°
- [x] ì±„íŒ…ë°©, ì±„íŒ…ë©”ì‹œì§€, ì±„íŒ…ë°© ì°¸ì—¬ì ì €ì¥ ë° ì¡°íšŒ
- [x] /sub /pub í•˜ë©´ì„œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### Transaction ì¶©ëŒ ë¬¸ì œ.
```
2025-02-06T17:38:54.236+09:00  INFO 14248 --- [backend] [boundChannel-22] B.backend.chat.service.ChatService       : Sending message: í—¬ë¡œ
2025-02-06T17:38:54.237+09:00 DEBUG 14248 --- [backend] [boundChannel-22] o.s.d.n.c.t.Neo4jTransactionManager      : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.save]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2025-02-06T17:38:54.241+09:00 DEBUG 14248 --- [backend] [boundChannel-22] o.s.d.n.c.t.Neo4jTransactionManager      : Initiating transaction commit
```

jpaë¡œ MySQLì— ê°’ì„ ì €ì¥í•˜ëŠ” ë° Neo4j Transaction ì´ ì‹¤í–‰ì´ ë˜ëŠ” ë¬¸ì œ ë°œìƒ!

```
// DatabaseConfig
@Configuration
public class DatabaseConfig {

    @Primary  // ì´ê²Œ ì¤‘ìš”í•©ë‹ˆë‹¤!
    @Bean
    public PlatformTransactionManager transactionManager(EntityManagerFactory entityManagerFactory) {
        return new JpaTransactionManager(entityManagerFactory);
    }

    @Bean("jpaTransactionManager")  // ëª…ì‹œì ìœ¼ë¡œ ì´ë¦„ ì§€ì •
    public PlatformTransactionManager jpaTransactionManager(EntityManagerFactory entityManagerFactory) {
        return new JpaTransactionManager(entityManagerFactory);
    }
}

// Neo4jConfig
public class Neo4jConfig {
    @Bean("neo4jTransactionManager")
    public Neo4jTransactionManager neo4jTransactionManager(Driver driver,               DatabaseSelectionProvider databaseSelectionProvider) {
        return new Neo4jTransactionManager(driver, databaseSelectionProvider);
    }
}

```
ìƒì„±ì ì£¼ì…ìœ¼ë¡œ Qulifier ë¡œ ì–´ë–¤ í…œí”Œë¦¿ì„ ì‚¬ìš©í•  ê²ƒì¸ì§€ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •.
```
public ChatService(@Qualifier("chatRedisTemplate") RedisTemplate<String, Object> chatRedisTemplate) {
    this.chatRedisTemplate = chatRedisTemplate;
}
```


transactionManager í•¨ìˆ˜ê°€ ë™ì¼í•´ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œ.
ë‹¤ìŒê³¼ ê°™ì´ Beanì˜ ì´ë¦„ì„ ì§€ì •í•´ì£¼ë©´ í•´ê²° ê°€ëŠ¥!

#### WebSocket í†µì‹ ê³¼ Security ì¶©ëŒ.
- ws: ì ‘ì†í•  ë•Œ SecurityConfig ì ‘ê·¼ ë¶ˆê°€ëŠ¥í•œ ë¬¸ì œê°€ ë°œìƒ.
- SecurityConfig, JwtAuthenticationFilter(shouldNotFilter)ì— í•´ë‹¹ URL ì¸ì¦ ì œì™¸

## :sparkles: 25.02.04(í™”)
[PROJECT]
- [x] ì˜ìƒ ëœë”ë§ í•©ì¹˜ê¸°
[BACK-FRONT]
- [x] ìì˜í•œ url ìˆ˜ì •
- [x] ìœ ì € Set-Cookieë¡œ accessTokne, refreshToken ë„˜ê²¨ì£¼ê¸°

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### **ë¡œê·¸ì¸ accessToken refreshToken ë„˜ê¸°ê¸°**
- accessToken, refreshToken ë°œê¸‰ í›„, Set-Cookieì— ë‹´ì•„ì„œ responseì— ë„˜ê²¨ì•¼í•¨.
- ìƒˆë¡œê³ ì¹¨í•´ë„ ê°’ì´ ë‚ ë¼ê°€ì§€ ì•Šê³ , logout í•˜ê±°ë‚˜, í† í°ì´ ë§Œë£Œë˜ì—ˆì„ ë•Œ ì‚¬ë¼ì§.
- HTTPS í™˜ê²½ì—ì„œë§Œ secure ì²˜ë¦¬ë¥¼ í•´ì•¼í•¨.
- í”„ë¡ íŠ¸ì—ì„œëŠ” withCredential: trueë¡œ ì„¤ì •í•˜ì—¬ ìë™ì ìœ¼ë¡œ ì¿ í‚¤ì— ë“¤ì–´ìˆëŠ” ê°’ì„ ê°€ì ¸ì˜¤ë„ë¡ í•¨.
- accessToken ì´ ë§Œë£Œë˜ì—ˆì„ ë•Œ, refresh í•  ë•ŒëŠ” refreshToken ìœ¼ë¡œ ê·¸ ì¸ì¦ìê°€ ë§ëŠ”ì§€ í™•ì¸í•˜ê³  accessTokenì„ ì¬ë°œê¸‰í•´ì¤Œ.
- ì¿ í‚¤ì—ì„œ HttpOnlyë¥¼ ì ìš©í•˜ë©´, javascriptì—ì„œ ì§ì ‘ accessToken, refreshTokenì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŒ.
=> XSS(Cross Site Scripting) ê³µê²© : ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ ê°™ì€ ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ ì‚½ì…í•´ ê°œë°œìê°€ ê³ ë ¤í•˜ì§€ ì•Šì€ ê¸°ëŠ¥ì´ ì‘ë™ë˜ê²Œ í•˜ëŠ” ê³µê²©.


## :sparkles: 25.01.24(ê¸ˆ)
[USER]
- [x] doFilterInternal - accessToken ë§Œë£Œ) refresh í† í° ê²€ì¦í•˜ëŠ” ë¡œì§ ì¶”ê°€ í•„ìš”!
- [ ] signup) ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì•…ê¸° ì¶”ê°€ í•„ìš”!
- [ ] ì´ë©”ì¼ ì¸ì¦ API - ë§Œë£Œ ê¸°ê°„ ê´€ë¦¬í•˜ê¸°!
- [ ] User ì´ë¯¸ì§€ S3 ì—°ê²°.

[CHAT]
- [x] 1:N ì±„íŒ… êµ¬í˜„ ë°©ì‹ ìë£Œì¡°ì‚¬ -> STOMP, Redis ì—°ë™!
- [x] 1:N ì±„íŒ… erd ìƒì„¸í•˜ê²Œ ì„¤ì • 
- [x] Kafka(ë©”ì‹œì§€ í) ì„œë²„ ë¡œì»¬ ì—°ê²°

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### **WSL**
- Kafk(ë©”ì‹œì§€ í) ì„œë²„ë¥¼ windowì— ë‹¤ìš´ ë°›ìœ¼ë©´ì„œ docker, docker-compose í•„ìš”í•´ì§
- docker desktop ë‹¤ìš´ìœ¼ë¡œ í•´ê²°!
- ì´ ê³¼ì •ì—ì„œ WSL -> window, linux ì—°ê²°í•˜ëŠ” ê²ƒ!ì— ëŒ€í•´ ì•Œì•„ë³´ê²Œ ë¨.

#### **S3 ë¹„ë””ì˜¤ ì—…ë¡œë“œ/ì˜ìƒ íŒŒì¼ ì¡°íšŒ ë°©ì‹**
[í´ë¼ì´ì–¸íŠ¸ -> ì„œë²„ -> S3 ì—…ë¡œë“œ]
1. S3ì— ì˜ìƒì„ ì—…ë¡œë“œí•˜ê²Œ ë˜ë©´, Multipart ë¡œ ì´ë¯¸ì§€ê°€ ì „ì†¡ë˜ê³ , ê·¸ ê°’ì„ S3ì— ì €ì¥í•˜ê²Œ ëœë‹¤.
2. S3ëŠ” ì„œë²„ì— ë§í¬ë¥¼ ë°˜í™˜í•˜ê³ , ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ URLì„ ë°˜í™˜í•œë‹¤.

[í´ë¼ì´ì–¸íŠ¸(url) -> ì„œë²„(url) -> S3 -> ì„œë²„(video) -> í´ë¼ì´ì–¸íŠ¸(video) íŒŒì¼ GET!]
1. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì—ê²Œ urlì„ ì „ë‹¬í•˜ë©´, ì„œë²„ëŠ” S3ì—ê²Œ íŒŒì¼ì„ ìš”ì²­í•œë‹¤.
2. S3ëŠ” ë¹„ë””ì˜¤ë¥¼ Multipartë¡œ ë°˜í™˜í•˜ê³ , ê·¸ ê°’ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•œë‹¤.


## :sparkles: 25.01.23(ëª©)
[USER]
- [ ] ~doFilterInternal - accessToken ë§Œë£Œ) refresh í† í° ê²€ì¦í•˜ëŠ” ë¡œì§ ì¶”ê°€ í•„ìš”!~
- [ ] swaggerì—ì„œ header ì…ë ¥ ê°€ëŠ¥í•˜ë„ë¡ ìˆ˜ì • í•„ìš”!

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### **Swaggerì™€ Advice Handler ì˜ Swagger ë²„ì „ ë¬¸ì œë¡œ ë°œìƒí•œ ì˜¤ë¥˜**
- NoSuchMethod. ì˜¤ë¥˜ê°€ ëœ¸.
- ë²„ì „ í˜¸í™˜ì„±ì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.

## :sparkles: 25.01.22 (ìˆ˜)
- [x] ì´ë©”ì¼ ì¸ì¦ API - ì´ë©”ì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ ê²€ì¦ ì¶”ê°€í•´ì•¼í•¨.
- [x] ë¡œê·¸ì¸ API - refresh Token ì‚­ì œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë‹¤ì‹œ ì ìš©.
- [x]] ì˜ˆì™¸ì²˜ë¦¬ í›„ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ!


### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### :bulb:**SOLID ê°ì²´ ì§€í–¥ ì›ì¹™**
> íš¨ê³¼: ì½”ë“œë¥¼ í™•ì¥í•˜ê³  ìœ ì§€ ë³´ìˆ˜ ê´€ë¦¬ê°€ ë” ì‰¬ì›Œì§€ë©°, ë³µì¡ì„±ì„ ì œê±°í•´ ê°œë°œì˜ ìƒì‚°ì„±ì„ ë†’ì„.
##### **S: ë‹¨ì¼ ì±…ì„ ì›ì¹™**
- í´ë˜ìŠ¤(ê°ì²´)ëŠ” ë‹¨ í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì ¸ì•¼ í•œë‹¤.
    - í•˜ë‚˜ì˜ í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ì—¬ í•˜ë‚˜ì˜ ì±…ì„ì„ ìˆ˜í–‰
##### **O: ê°œë°© íì‡„ ì›ì¹™**
- í™•ì¥ì—” ì—´ë ¤ìˆì–´ì•¼ í•˜ë©°, ìˆ˜ì •ì—ëŠ” ë‹«í˜€ìˆì–´ì•¼ í•œë‹¤.
    - [í™•ì¥ì— ì—´ë ¤ìˆë‹¤] - ìƒˆë¡œìš´ ë³€ê²½ ì‚¬í•­ ë°œìƒí–ˆì„ ë•Œ, ìœ ì—°í•˜ê²Œ ì½”ë“œë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŒ.
    - [ë³€ê²½ì— ë‹«í˜€ìˆë‹¤] - ìƒˆë¡œìš´ ë³€ê²½ ì‚¬í•­ì´ ë°œìƒí–ˆì„ ë•Œ, ê°ì²´ ì§ì ‘ì  ìˆ˜ì • ì œí•œ
##### **L: ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜ ë²•ì¹™**
- ì„œë¸Œ íƒ€ì…ì€ ì–¸ì œë‚˜ ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ êµì²´í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
##### **I: ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™**
- ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°ê° ì‚¬ìš©ì— ë§ê²Œ ì˜ê²Œ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.
- ì¸í„°í˜ì´ìŠ¤ì˜ ë‹¨ì¼ ì±…ì„ ê°•ì¡°
##### **D: ì˜ì¡´ ì—­ì „ ì›ì¹™**
- Classë¥¼ ì°¸ì¡°í•´ì„œ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ìƒí™©ì´ë¼ë©´, ì§ì ‘ ì°¸ì¡°ë³´ë‹¨, ëŒ€ìƒì˜ ìƒìœ„ ìš”ì†Œ(ì¶”ìƒ í´ë˜ìŠ¤ or ì¸í„°í˜ì´ìŠ¤)ë¡œ ì°¸ì¡°í•´ì•¼í•œë‹¤.
- êµ¬í˜„ í´ë˜ìŠ¤ì— ì˜ì¡´í•˜ì§€ ë§ê³ , ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ë¼.

#### :bulb:**JWT í† í° ì²˜ë¦¬ | doFilterInternal í”„ë¡œì„¸ìŠ¤**
##### **doFilterInternal: Filterì˜ í•µì‹¬ ë©”ì„œë“œ <- OncePerRequestFilter ìƒì† ë°›ì•„ êµ¬í˜„**
- DispatcherServlet ì´ì „ì— ì‹¤í–‰ë˜ëŠ” Spring Filter ì²´ì¸ ë‚´ì—ì„œ ì‘ë™í•¨.
- Request ë“¤ì–´ì™”ì„ ë•Œ, ì‘ë™ ìˆœì„œ
    1. Filter ì²´ì¸ì˜ ì•ìª½ì— ìœ„ì¹˜í•œ í•„í„°ë“¤ì´ ìš”ì²­ì„ ì²˜ë¦¬
    2. ì‚¬ìš©ì ì •ì˜ doFilterInternal ë©”ì„œë“œ ì‹¤í–‰
    3. í•„í„° ì²´ì¸ì„ í†µí•´ ìš”ì²­ì´ DispatcherServletì— ë„ë‹¬


#### :bulb:**AOP**

##### **AOPë€?**

##### **BaseException** ì˜ˆì™¸ì²˜ë¦¬

##### **@ControllerAdviceì˜ ì‘ë™ ìˆœì„œ**
1. ìš”ì²­ì´ DispatcherServletì„ í†µí•´ Controllerë¡œ ì „ë‹¬.
2. Controllerì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´, @ControllerAdviceì— ì •ì˜ëœ ExceptionHandler ë©”ì„œë“œ ì‹¤í–‰
3. ExceptionHandlerëŠ” í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µ ë°˜í™˜.

##### **doFilterInternal, @ControllerAdvice í†µí•©**
1. ìš”ì²­(Request) â†’ í•„í„° ì²´ì¸ ì‹¤í–‰ (doFilterInternal ì‹¤í–‰ í¬í•¨)
2. DispatcherServlet ì‹¤í–‰
Controllerë¡œ ìš”ì²­ ì „ë‹¬
3. Controllerì—ì„œ ì‘ì—… ìˆ˜í–‰
- ì •ìƒ ì²˜ë¦¬: ì‘ë‹µ(Response)ì„ í•„í„° ì²´ì¸ìœ¼ë¡œ ë°˜í™˜
- ì˜ˆì™¸ ë°œìƒ: @ControllerAdviceì˜ ExceptionHandler ì‘ë™
5. í´ë¼ì´ì–¸íŠ¸ë¡œ ìµœì¢… ì‘ë‹µ ë°˜í™˜


### :white_check_mark: ì–´ë ¤ì› ë˜ ì 


## :sparkles: 25.01.21 (í™”)
- [ ] íšŒì›ê°€ì… API - ì´ë©”ì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ ê²€ì¦ ì¶”ê°€í•´ì•¼í•¨.
- [x] ë¡œê·¸ì¸ access Token, refresh Token Redis ì €ì¥
- [x] ë¡œê·¸ì•„ì›ƒ ë¸”ë™ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬
- [x] íšŒì›ì •ë³´ ìˆ˜ì •/íšŒì›íƒˆí‡´ API

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### :bulb:**ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ í”„ë¡œì„¸ìŠ¤**
> (Spring + JWT + Redis ì‚¬ìš©)

**<ë¡œê·¸ì¸>**
1. ìœ ì €ê°€ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ë¡œê·¸ì¸í•œë‹¤.
2. ì„œë²„ì—ì„œ accessToken, refreshToken ì„ ìƒì„±í•˜ì—¬ Redis DBì— ì €ì¥í•˜ê³ , ë‘ ê°’ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°˜í™˜í•œë‹¤.

**<ë¡œê·¸ì•„ì›ƒ>**
1. ìœ ì €ê°€ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì„ ëˆ„ë¥¸ë‹¤.
2. accessTokenì„ ë³´ë‚´ë©´ Redis DBì— ```"BlackList: "+accessToken``` ê°’ì„ ì €ì¥í•˜ê³ ,
refreshTokenì„ ì‚­ì œí•œë‹¤.
> (ë‹¤ë¥¸ ë°©ë²•) accessToken, refreshToken ë‘˜ ë‹¤ ì‚­ì œ(?)
3. ë¡œê·¸ì•„ì›ƒ ëœë‹¤.

**<ìœ ì €ê°€ ë‹¤ë¥¸ ê¸°ëŠ¥ ì‚¬ìš©í•  ë•Œ>**
1. ê°€ì§€ê³  ìˆëŠ” accessTokenì„ í—¤ë”ì— í¬í•¨í•´ì„œ ìì›ì„ ìš”ì²­í•œë‹¤.
2. accessTokenì´ BlackListì— ìˆë‹¤ë©´, ì´ë¯¸ í† í°ì´ ë§Œë£Œë˜ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
3. doFilterInternal ì—ì„œ ì¸ì¦ ê´€ë¦¬ë¥¼ í•˜ë©´, ê¸°ëŠ¥ ì ‘ê·¼ ë¶ˆê°€!

##### Refresh Tokenì˜ í•„ìš”ì„±
```
í† í°ì˜ ìœ íš¨ì‹œê°„ì´ ì§§ë‹¤ë©´ -> ê³µê²©í•˜ëŠ” ì‚¬ëŒì´ íƒˆì·¨í•´ë„ ê¸ˆë°© í† í°ì´ ë§Œë£Œë¨.
 => ìœ íš¨ì„± í†µê³¼ë¥¼ ê¸ˆë°© í•˜ì§€ ëª»í•˜ê²Œ ë  ê²ƒ.
BUT, ë¬¸ì œëŠ” ì´ë ‡ê²Œ ë˜ë©´ ì‚¬ìš©ìëŠ” ê³„ì† ë¡œê·¸ì¸ì„ ë°˜ë³µí•´ì•¼í•˜ëŠ” ë¶ˆí¸í•¨ ìƒê¹€.

ë”°ë¼ì„œ, RefreshTokenìœ¼ë¡œ ë‹¤ì‹œ accessToken ë°œê¸‰ ê°€ëŠ¥í•˜ë„ë¡, RefreshToken ë„ì…!
```

### :white_check_mark: ì–´ë ¤ì› ë˜ ì 
#### :bulb:**ìŠ¤í”„ë§ë¶€íŠ¸ ì‹œíë¦¬í‹° ì˜ì¡´ì„± ì¶”ê°€ë¡œ ì¼ì–´ë‚˜ëŠ” ì¼ë“¤**
```
implementation 'org.springframework.boot:spring-boot-starter-security'
```
ë¥¼ ì¶”ê°€í•˜ë©´ì„œ ëª¨ë“  url ì ‘ê·¼ì— ì¸ì¦ì´ í•„ìš”í•´ì§.
=> SecurityConfig ì—ì„œ securityFilterChain ì—ì„œ ìš”ì²­ ì¸ì¦ì„ ì œì™¸í•´ì•¼í•¨.
spring ë²„ì „ë§ˆë‹¤ securityFilter ì„¤ì • ë°©ì‹ì´ ë‹¤ë¦„!!
https://ttasjwi.tistory.com/148


## :sparkles: 25.01.20 (ì›”)
- [ ] íšŒì›ê°€ì… API - ì´ë©”ì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ ê²€ì¦ ì¶”ê°€í•´ì•¼í•¨.
- [ ] ë¡œê·¸ì¸ access Token 
- [ ] ë¡œê·¸ì¸ ì˜ˆì™¸ì²˜ë¦¬ í›„ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ!
- [ ] 1:N ì±„íŒ… êµ¬í˜„ ë°©ì‹ ìë£Œì¡°ì‚¬
- [ ] 1:N ì±„íŒ… erd ìƒì„¸í•˜ê²Œ ì„¤ì •


### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### access Token vs. refresh Token

#### Redis
- in-memoryì— ìˆëŠ” ê°’ì„ ì¡°íšŒí•˜ê¸° ë•Œë¬¸ì— RDBMS ë³´ë‹¤ ë°ì´í„° ì ‘ê·¼ ì†ë„ê°€ ë¹ ë¥´ë‹¤.
=> ë¡œê·¸ì¸ access Token ê³¼ refresh Token ì„ redisë¡œ ê´€ë¦¬.

### :white_check_mark: ì–´ë ¤ì› ë˜ ì 
> í¸ì§‘ í™”ë©´ êµ¬ì„± íšŒì˜ì— 3ì‹œê°„ì„ ì¼ìŒ.
> ê°œë°œ ì‹œê°„ ê´€ë¦¬ë¥¼ í•˜ë©° íšŒì˜ë¥¼ í•´ì•¼í•  ê²ƒ ê°™ìŒ!
> í™”ì´íŒ…!

## :sparkles: 25.01.17 (ê¸ˆ)
- [x] íšŒì›ê°€ì… API - ì´ë©”ì¼ ì¸ì¦
- [x] íšŒì›ê°€ì… API - ì•”í˜¸í™”
- [x] ë¡œê·¸ì¸ API
- [ ] 1:N ì±„íŒ… êµ¬í˜„ ë°©ì‹ ìë£Œì¡°ì‚¬
- [ ] 1:N ì±„íŒ… erd ìƒì„¸í•˜ê²Œ ì„¤ì •

### ì˜¤ëŠ˜ ì¶”ê°€ To-do
- [ ] íšŒì›ê°€ì… API - ì´ë©”ì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ ê²€ì¦ ì¶”ê°€í•´ì•¼í•¨.
- [ ] ì˜ˆì™¸ì²˜ë¦¬ ë°©ì‹ í™•ì • ë° ì •ë¦¬í•´ë³´ê¸°!
- [ ] ë¡œê·¸ì¸ ì˜ˆì™¸ì²˜ë¦¬ í›„ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ!

### :white_check_mark: ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì 
#### :bulb: **ì´ë©”ì¼ ì¸ì¦: spring-boot-starter-mail**
##### SMTP ì‚¬ìš©
- spring-boot-starter-mail ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
- 6ìë¦¬ ì¸ì¦ì½”ë“œ ëœë¤ìœ¼ë¡œ ìƒì„±
- javaMailSender ë¹ˆì„ ì£¼ì… ë°›ê³ , contentë¥¼ MimeMessage ê°ì²´ì— ë‹´ì•„ì„œ ì´ë©”ì¼ì„ ì „ì†¡í•œë‹¤.
##### SMTP(Simple Mail Transfer Protocol) ë€?
> **ì „ìë©”ì¼ ì „ì†¡í•  ë•Œ ì“°ì´ëŠ” í‘œì¤€ í”„ë¡œí† ì½œ**
> - í¬íŠ¸ë²ˆí˜¸ 465 or 587 ì‚¬ìš©
##### í¬íŠ¸ë²ˆí˜¸ 465 vs. 587
- í¬íŠ¸ 465: *SMTPìš©*ìœ¼ë¡œ SMTP ì•”í˜¸í™” ì „ì— SMTP ì•”í˜¸í™”ê°€ ìë™ìœ¼ë¡œ ì‹œì‘.
- í¬íŠ¸ 587: *msaìš©*ìœ¼ë¡œ í‘œì¤€ SMTP í¬íŠ¸ì™€ ê±°ì˜ ê°™ìŒ.
=> ë³´ì•ˆìƒ, ë˜ë„ë¡ 587í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ê¶Œì¥

#### :bulb:**ì•”í˜¸í™”: spring-security-web**
- spring-security-web ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
##### Spring Security ë€?
> ìë°” ì„œë²„ ê°œë°œì„ ìœ„í•´ í•„ìš”ë¡œ í•œ ì¸ì¦, ê¶Œí•œ ë¶€ì—¬ ë° ê¸°íƒ€ ë³´ì•ˆ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” í”„ë ˆì„ì›Œí¬
- BCryptPasswordEncoder í¬í•¨
##### BCryptPasswordEncoder ë€?
- BCrypt í•´ì‹± í•¨ìˆ˜(BCrypt hashing function)ë¥¼ ì‚¬ìš©í•´ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¸ì½”ë”© ë©”ì„œë“œ ì œê³µ
- ì‚¬ìš©ìì˜ ì˜í•´ ì œì¶œëœ ë¹„ë°€ë²ˆí˜¸ì™€ ì €ì¥ì†Œì— ì €ì¥ë˜ì–´ ìˆëŠ” ë¹„ë°€ë²ˆí˜¸ì˜ ì¼ì¹˜ ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ëŠ” ë©”ì„œë“œ ì œê³µ 

#### :bulb:**ìƒì„±ì ì£¼ì… vs. @Autowired**
##### ìƒì„±ì ì£¼ì…
- ìˆœí™˜ ì°¸ì¡° ë°©ì§€ ê°€ëŠ¥!!
- ìƒì„±ìë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ì‹œì ì— í•„ìš”í•œ ë¹ˆì„ ì£¼ì….
- ìƒì„±ìì˜ ì¸ìì— ì‚¬ìš©ë˜ëŠ” ë¹ˆì„ ì°¾ê±°ë‚˜ ë¹ˆ íŒ©í† ë¦¬ì—ì„œ ë§Œë“¦.
- ê·¸ í›„ì— ì°¾ì€ ì¸ì ë¹ˆìœ¼ë¡œ ì£¼ì…í•˜ë ¤ëŠ” ë¹ˆì˜ ìƒì„±ìë¥¼ í˜¸ì¶œ.
-> **ë¨¼ì € ë¹ˆ ìƒì„± X**
##### í•„ë“œ ì£¼ì…(@Autowired)
- ë¨¼ì € ë¹ˆì„ ìƒì„±í•œ í›„, ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í•„ë“œì— í•´ë‹¹í•˜ëŠ” ë¹ˆì„ ì°¾ì•„ì„œ ì£¼ì…í•¨.
-> **ë¨¼ì € ë¹ˆì„ ìƒì„±**í•œ í›„ í•„ë“œì— ëŒ€í•´ ì£¼ì…

#### :bulb:**ë¡œê·¸ì¸ POST vs. GET**
- GET ë°©ì‹ìœ¼ë¡œ URLì— ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹´ì•„ì„œ ìš”ì²­ì„ ë³´ë‚´ê²Œ ë˜ë©´ ë³´ì•ˆìƒ ì·¨ì•½í•˜ê²Œ ëŠê»´ì§.

### :white_check_mark: ì–´ë ¤ì› ë˜ ì 
<hr/><hr/>

## :sparkles: 25.01.16 (ëª©)
- [x] swagger ì—°ë™
- [x] neo4j local í™˜ê²½ì—ì„œ ì—°ë™
- [x] íšŒì›ê°€ì… API - ì´ë©”ì¼ ì¸ì¦, ì•”í˜¸í™” X
- [ ] ë¡œê·¸ì¸ API

### ê¸°íš
- ì±„íŒ…) ë‹¤ì‹œ ì„¤ê³„ í•„ìš”í•¨. ì¶”ê°€ ì—…ë¡œë“œ ì˜ˆì •!

### DB - neo4j
- [ë¬¸ë²•]
    -  CREATE: ë…¸ë“œ, ê´€ê³„ë¥¼ ìƒì„±
    > create (ì§±êµ¬:Person {name:'ì§±êµ¬'}),(ë§¹êµ¬:Person {name:'ë§¹êµ¬'}),(í°ë‘¥ì´:Dog {name:'í°ë‘¥ì´'}), (ì§±êµ¬)-[:friend]->(ë§¹êµ¬),(ë§¹êµ¬)-[:friend]->(ì§±êµ¬),(í°ë‘¥ì´)-[:master]->(ì§±êµ¬)

    -  MATCH: ê¸°ì¡´ ë…¸ë“œ, ê´€ê³„ë¥¼ ê²€ìƒ‰. WHEREê³¼ í•¨ê»˜ ì“°ë©´ ì¡°ê±´ë¶€ ê²€ìƒ‰ ê°€ëŠ¥.
    > MATCH < pattern > WHERE < conditions > RETURN < expression >
    > ex) match (p:Person{name:"ì§±êµ¬"}) set p.age=5,p.gender='male' return p


## :sparkles: 25.01.15 (ìˆ˜)

### ê¸°íš
- ERD ì„¤ê³„ ìˆ˜ì • í•„ìš”ì„± ë°œê²¬
    - í”„ë¡œì íŠ¸ ê°„ì˜ ìì‹, ë¶€ëª¨ ë…¸ë“œë“¤ì˜ ì „ì²´ ê´€ê³„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” "ê°€ì¡±ê´€ê³„ë„" í•„ìš”í•´ì§.
    - Graph DB ì‚¬ìš©ì˜ í•„ìš”ì„± => Neo4j í™œìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ê²°ì •

### DB
- Graph DBë€?
    - ë…¸ë“œ(node)ì™€ ì—£ì§€(edge)ë¡œ í‘œí˜„í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤
    - GDB vs. RDB
        - RDBì™€ ë‹¤ë¥´ê²Œ Join ì—°ì‚°ì„ í†µí•´ ë‘ ê°œì²´ë¥¼ ì—°ê²°í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ë°”ë¡œ ê°„ì„ ì„ í†µí•´ íƒìƒ‰ì„ í•˜ì—¬ ì¿¼ë¦¬ ì†ë„ í–¥ìƒ.


## :sparkles: 25.01.14 (í™”)

### ê¸°íš
- ì™€ì´ì–´í”„ë ˆì„ ì‘ì„±í•˜ë©´ì„œ ì„¸ë¶€ ê¸°ëŠ¥ë“¤ í™•ì •.
- ì±„íŒ…) ë©”ì‹œì§€ ì½ìŒ/ì•ˆì½ìŒ í‘œì‹œ
    - STOMP ë°©ì‹ìœ¼ë¡œ Redisë¥¼ í™œìš©í•œ readCount ì •ë³´ ê´€ë¦¬.
    
    ì±„íŒ…ì„ í•˜ëŠ” ë‘ ëª… ëª¨ë‘ê°€ ì±„íŒ…ë°©ì— ìˆëŠ” ê²½ìš°

    Stompë¥¼ ê¸°ë°˜ìœ¼ë¡œí•œ pub/sub êµ¬ì¡°ì´ë¯€ë¡œ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ subscribe í•˜ìë§ˆì ì„œë²„ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì½ì—ˆìŒì„ ì•Œë¦°ë‹¤.
    ì´ ë•Œ /chat/{chat-id} ë¼ëŠ” ì—”ë“œí¬ì¸íŠ¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ ì„œë²„ì—ê²Œ ë©”ì‹œì§€ ì½ì—ˆìŒì„ ì•Œë¦°ë‹¤.
    ìœ„ ìš”ì²­ì„ ë°›ìœ¼ë©´ ì„œë²„ëŠ” chat-idì— í•´ë‹¹í•˜ëŠ” ì±„íŒ…ì˜ readCountë¥¼ ê°ì†Œì‹œí‚¨ë‹¤.Â 
    ì´ëŸ° ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ subscriberê°€ ë‘ëª…ì´ë¯€ë¡œ readCountê°€ 2ë§Œí¼ ê°ì†Œí•˜ê²Œ ë˜ê³ , readCountê°€ 0ì¸ ê²ƒì„ í†µí•´ í•´ë‹¹ ì±„íŒ…ì€ ë‘ ëª… ëª¨ë‘ê°€ ì½ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


    í•œëª…ë§Œ ì±„íŒ…ë°©ì— ìˆëŠ” ê²½ìš°Â 

    ìœ„ ë°©ì‹ëŒ€ë¡œ í•˜ë©´ readCountëŠ” 1ì´ ê°ì†Œí•˜ê²Œ ëœë‹¤. (ì±„íŒ…ë°©ì˜ subscriberê°€ í•œëª…ì´ë¯€ë¡œ)
    ë‚¨ì€ readCount 1ì€ ë‚˜ë¨¸ì§€ í•œëª…ì´ ì±„íŒ…ë°©ì„ ë¶ˆëŸ¬ì˜¬ ë•Œ readCountë¥¼ 1 ê°ì†Œì‹œí‚¨ë‹¤.Â 
    ì£¼ì˜) ì±„íŒ…ë°©ì„ ë¶ˆëŸ¬ì˜¬ ë•Œ ë‚´ê°€ ë°œì‹ ìê°€ ì•„ë‹Œ ê²½ìš° && readCount == 1 ì¸ ê²½ìš°ë§Œ readCountë¥¼ 1 ê°ì†Œì‹œí‚¨ë‹¤.



    ìœ„ì™€ ê°™ì€ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ readCount ë¼ëŠ” ê°’ì„ í†µí•´ ì±„íŒ…ì„ ìƒëŒ€ë°©ì´ ì½ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì•Œ ìˆ˜ ìˆê²Œ ë˜ê³ , ì´ë¥¼ í†µí•´ ì•ˆì½ì€ ë©”ì‹œì§€ê°€ ëª‡ê°œ ì¸ì§€ë„ íŒŒì•…í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.
    => ì¶œì²˜: https://kjhoon0330.tistory.com/entry/Spring-ì±„íŒ…-ì½ìŒ-í™•ì¸-ê¸°ëŠ¥-êµ¬í˜„í•˜ê¸°#2. 1. ìš”êµ¬ì‚¬í•­ğŸ“• [Jahni's Blog:í‹°ìŠ¤í† ë¦¬]

### ì–´ë ¤ì› ë˜ ì .
- 6ì¸ í”„ë¡œì íŠ¸íŠ¸ í˜‘ì—…ì—ì„œì˜ ì–´ë ¤ì›€ì„ ê¹¨ë‹¬ìŒ.
    - ì „ì²´ì ì¸ ê·¸ë¦¼ì„ ê·¸ë¦¬ê³ , ê·¸ í›„ë¡œ ì™€ì´ì–´í”„ë ˆì„ê³¼ ERD ì„¤ê³„ë¥¼ í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
    - ë™ì¼í•œ ê²ƒì— ëŒ€í•´ ìƒê°í•˜ëŠ” ê²ƒì´ ëª¨ë‘ ë‹¤ë¦„. (:sparkles: ì†Œí†µì˜ ì¤‘ìš”ì„±)


## :sparkles: 25.01.13 (ì›”)

### ê¸°íš

- í”„ë¡œì íŠ¸ ëª… í™•ì •
    - Blendeo (Blend + video)
- ë¹„ë””ì˜¤ ë£¨í”„ìŠ¤í…Œì´ì…˜ ëŒ€ìƒ ì„¤ì •
    - ABC ë¡œ ë™ì˜ìƒì´ ìŒ“ì˜€ë‹¤ë©´, ì‚¬ì´ì˜ ë™ì˜ìƒ ìˆ˜ì • ë° ì‚­ì œ ë¶ˆê°€ëŠ¥.

### DB ì„¤ê³„
- erdCloud ë¡œ í˜‘ì—…
    - git ê³¼ ìœ ì‚¬í•˜ê²Œ, ë™ì˜ìƒ fork í•˜ëŠ” ë°©ì‹ í† ì˜
